<!DOCTYPE html>
<html lang="en" class="no-js">

<head>
    <meta charset="utf-8" />
    <title>FlameOnePage Free Template by FairTech</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <meta content="FlameOnePage freebie theme for web startups by FairTech SEO." name="description" />
    <meta content="FairTech" name="author" />
    <link href="http://fonts.googleapis.com/css?family=Hind:300,400,500,600,700" rel="stylesheet" type="text/css">
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    <link href="/static/home/vendor/simple-line-icons/simple-line-icons.min.css" rel="stylesheet" type="text/css" />
    <link href="/static/home/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="/static/home/css/animate.css" rel="stylesheet">
    <link href="/static/home/vendor/swiper/css/swiper.min.css" rel="stylesheet" type="text/css" />
    <link href="/static/home/css/layout.min.css" rel="stylesheet" type="text/css" />
    <link href="/static/home/css/layout.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="shortcut icon" href="favicon.ico" />
   
</head>

<body id="body" data-spy="scroll" data-target=".header">
    <%- include('partical/header'); %>
    
        <div id="movie-detail" class="movie-detail-card">
            <div class="poster-detail">
                <img id="movie-poster" class="poster" src="" alt="Movie poster">
            </div>
            <div class="item-detail">
                <div class="title">
                    <h4 id="movie-title"></h4>
                    <div class="title-row">
                        <h5 id="movie-origin-name"></h5>
                        <h6 id="movie-status"></h6>
                    </div>

                </div>

                <div class="movie-categories">
                    <span id="movie-type"></span>
                    <span id="movie-countries"></span>
                    <span id="movie-categories"></span>
                </div>
                <div class="action-row small-buttons">
                    <a id="play-button" href="#" class="play-button"> <i class="bi bi-play-fill"></i></a>
                    <a id="detail-button" href="#" class="detail-button"><i class="bi bi-info-lg"></i></a>
                    <p id="movie-lang"></p>
                    <p> + </p>
                    <p id="movie-quality"></p>


                </div>
            </div>
        </div>

        <div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
            <div class="container">
                <ol class="carousel-indicators" id="carousel-indicators">
                    <!-- Indicators will be injected here by JavaScript -->
                </ol>
            </div>

            <div class="carousel-inner" role="listbox" id="carousel-content">
                <!-- Carousel items will be injected here by JavaScript -->
            </div>
        </div>

        <div class="container-fluid">

            <div class="row">
                <div class="col-sm-12">
                    <h2>Phim Mới Không Kịp Xơi</h2>
                </div>
            </div>
            <div class="cards">
                <div class="row">
                    <div class="masonry-grid-sizer col-xs-2 col-sm-2">
                        <h2 class="cartoon">Anime</h2>
                    </div>
                    <div id="anime-slider" class="swiper-container col-xs-10 col-sm-10">
                        <div class="swiper-wrapper">
                            <!-- Slides sẽ được thêm bằng JavaScript -->
                        </div>
                        <div class="swiper-button">
                            <div class="swiper-button-next"></div>
                            <div class="swiper-button-prev"></div>
                        </div>
                        <!-- Nút điều hướng -->

                    </div>
                </div>
            </div>
            <div class="cards">
                <div class="row">
                    <div class="masonry-grid-sizer col-xs-2 col-sm-2">
                        <h2 class="korean">Phim Hàn Mớii Coóng</h2>
                    </div>
                    <div id="hanquoc-slider" class="swiper-container col-xs-10 col-sm-10">
                        <div class="swiper-wrapper">
                            <!-- Slides sẽ được thêm bằng JavaScript -->
                        </div>
                        <div class="swiper-button">
                            <div class="swiper-button-next"></div>
                            <div class="swiper-button-prev"></div>
                        </div>
                        <!-- Nút điều hướng -->

                    </div>
                </div>
            </div>
            <div class="cards">
                <div class="row">
                    <div class="masonry-grid-sizer col-xs-2 col-sm-2">
                        <h2 class="china">Phim Trung Mới Tinh</h2>
                    </div>
                    <div id="trungquoc-slider" class="swiper-container col-xs-10 col-sm-10">
                        <div class="swiper-wrapper">
                            <!-- Slides sẽ được thêm bằng JavaScript -->
                        </div>
                        <div class="swiper-button">
                            <div class="swiper-button-next"></div>
                            <div class="swiper-button-prev"></div>
                        </div>
                        <!-- Nút điều hướng -->

                    </div>
                </div>
            </div>

        </div>

            <div class="container-fluid">
                <div class="row">
                    <div class="col-sm-12">
                        <h2>Chiếu Rạp Tại Nhà</h2>
                    </div>
                </div>
                <!--// end row -->

                <div id="chieurap-slider" class="swiper-container ">
                    <!-- Latest Products -->
                    <div class="swiper-wrapper ">

                    </div>
                    <div class="swiper-button">
                        <div class="swiper-button-next"></div>
                        <div class="swiper-button-prev"></div>
                    </div>

                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <h2>Lồng Tiếng Khỏi Đọc Sub</h2>
                    </div>
                </div>
                <!--// end row -->

                <div id="longtieng-slider" class="swiper-container ">
                    <!-- Latest Products -->
                    <div class="swiper-wrapper ">

                    </div>
                    <div class="swiper-button">
                        <div class="swiper-button-next"></div>
                        <div class="swiper-button-prev"></div>
                    </div>

                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <h2>Hoài Niệm Phim Từ Thập Kỷ Trước</h2>
                    </div>
                </div>
                <!--// end row -->

                <div id="phimcu-slider" class="swiper-container ">
                    <!-- Latest Products -->
                    <div class="swiper-wrapper ">

                    </div>
                    <div class="swiper-button">
                        <div class="swiper-button-next"></div>
                        <div class="swiper-button-prev"></div>
                    </div>

                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <h2>Shows Truyền Hình Hót Hít</h2>
                    </div>
                </div>
                <!--// end row -->

                <div id="tvshows-slider" class="swiper-container ">
                    <!-- Latest Products -->
                    <div class="swiper-wrapper ">

                    </div>
                    <div class="swiper-button">
                        <div class="swiper-button-next"></div>
                        <div class="swiper-button-prev"></div>
                    </div>

                </div>
             
        </div>
        <footer class="footer bg-light">
            <!-- Links -->
            <div class="section-seperator">
                <div class="content-md container">
                    <div class="row">
                        <div class="col-sm-2 sm-margin-b-30">
                            <!-- List -->
                            <ul class="list-unstyled footer-list">
                                <li class="footer-list-item"><a href="#body">Home</a></li>
                                <li class="footer-list-item"><a href="#about">Team</a></li>
                                <li class="footer-list-item"><a href="#work">Credentials</a></li>
                                <li class="footer-list-item"><a href="#contact">Contact</a></li>
                            </ul>
                            <!-- End List -->
                        </div>
                        <div class="col-sm-2 sm-margin-b-30">
                            <!-- List -->
                            <ul class="list-unstyled footer-list">
                                <li class="footer-list-item"><a href="#">Twitter</a></li>
                                <li class="footer-list-item"><a href="#">Facebook</a></li>
                                <li class="footer-list-item"><a href="#">Instagram</a></li>
                                <li class="footer-list-item"><a href="#">YouTube</a></li>
                            </ul>
                            <!-- End List -->
                        </div>
                        <div class="col-sm-3">
                            <!-- List -->
                            <ul class="list-unstyled footer-list">
                                <li class="footer-list-item"><a href="#">Subscribe to Our Newsletter</a></li>
                                <li class="footer-list-item"><a href="#">Privacy Policy</a></li>
                                <li class="footer-list-item"><a href="#">Terms &amp; Conditions</a></li>
                            </ul>
                            <!-- End List -->
                        </div>
                    </div>
                    <!--// end row -->
                </div>
            </div>
            <!-- End Links -->

            <!-- Copyright -->
            <div class="content container">
                <div class="row">
                    <div class="col-xs-6">
                        <img class="footer-logo" src="/static/home/img/logo.png" alt="flameonepage Logo">
                    </div>
                    <div class="col-xs-6 text-right">
                        <p class="margin-b-0"><a class="fweight-700" href="#">FlameOnePage</a> Theme Powered by: <a
                                class="fweight-700" href="http://ft-seo.ch/">FairTech Studio</a></p>
                    </div>
                </div>
                <!--// end row -->
            </div>
            <!-- End Copyright -->
        </footer>



        <a href="javascript:void(0);" class="js-back-to-top back-to-top">Top</a>

        <script src="/static/home/vendor/jquery.min.js" type="text/javascript"></script>
        <script src="/static/home/vendor/jquery-migrate.min.js" type="text/javascript"></script>
        <script src="/static/home/vendor/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
        <script src="/static/home/vendor/jquery.easing.js" type="text/javascript"></script>
        <script src="/static/home/vendor/jquery.back-to-top.js" type="text/javascript"></script>
        <script src="/static/home/vendor/jquery.smooth-scroll.js" type="text/javascript"></script>
        <script src="/static/home/vendor/jquery.wow.min.js" type="text/javascript"></script>
        <script src="/static/home/vendor/swiper/js/swiper.jquery.min.js" type="text/javascript"></script>
        <script src="/static/home/vendor/masonry/jquery.masonry.pkgd.min.js" type="text/javascript"></script>
        <script src="/static/home/vendor/masonry/imagesloaded.pkgd.min.js" type="text/javascript"></script>
        <script src="/static/home/js/layout.min.js" type="text/javascript"></script>
        <script src="/static/home/js/components/wow.min.js" type="text/javascript"></script>
        <script src="/static/home/js/components/swiper.min.js" type="text/javascript"></script>
        <script src="/static/home/js/components/masonry.min.js" type="text/javascript"></script>
        <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

        <script>
            $(document).ready(function () {
                function fetchMovies(url, callback) {
                    $.ajax({
                        url: url,
                        method: 'GET',
                        success: callback,
                        error: function (err) {
                            console.error('Error fetching movies:', err);
                        }
                    });
                }

                const typeMap = {
                    'tvshows': 'TV shows',
                    'hoathinh': 'Hoạt hình',
                    'series': 'Phim bộ',
                    'single': 'Phim lẻ'
                };

                const statusMap = {
                    'ongoing': 'Đang chiếu',
                    'trailer': 'Sắp chiếu',
                    'completed': 'Hoàn tất'
                };
                function renderMovieDetails(movieData) {
                    $('#movie-title').text(movieData.name);
                    $('#movie-origin-name').text(movieData.origin);
                    $('#movie-lang').text(movieData.lang);
                    $('#movie-quality').text(movieData.quality);
                    $('#movie-status').html(`<span class="status-text">[${statusMap[movieData.status] || 'Unknown'}]</span>`);
                    $('#movie-poster').attr('src', movieData.poster);
                    $('#movie-type').html(`<a href="/filter?type=${movieData.type}" class="btn-theme btn-theme-sm btn-white-brd text-uppercase">${typeMap[movieData.type] || 'Unknown'}</a>`);
                    $('#movie-countries').html(
                        movieData.countries
                            .split(', ')
                            .map(countryStr => {
                                const match = countryStr.match(/\((.*?)\)/); // Lấy slug trong dấu ()
                                const slug = match ? match[1] : ''; // Nếu có slug, lấy nó
                                const name = countryStr.split(' (')[0]; // Lấy tên danh mục

                                return slug ? `<a href="/filter?country=${slug}" class="btn-theme btn-theme-sm btn-white-brd">${name}</a>` : '';
                            })
                            .join(' ')
                    );
                    $('#movie-categories').html(
                        movieData.categories
                            .split(', ')
                            .map(categoryStr => {
                                const match = categoryStr.match(/\((.*?)\)/); // Lấy slug trong dấu ()
                                const slug = match ? match[1] : ''; // Nếu có slug, lấy nó
                                const name = categoryStr.split(' (')[0]; // Lấy tên danh mục

                                return slug ? `<a href="/filter?genre=${slug}" class="btn-theme btn-theme-sm btn-white-brd">${name}</a>` : '';
                            })
                            .join(' ')
                    );

                    let playUrl = `/phim/${movieData.slug}`;
                    $('#play-button')
                        .attr('href', playUrl) // Cập nhật href
                        .data('slug', movieData.slug) // Gán slug
                        .removeClass('disabled');

                    $.ajax({
                        url: `/api/movies/${movieData.slug}`,
                        method: 'GET',
                        success: function (response) {
                            if (response.episodes?.length > 0) {
                                const firstEpisode = response.episodes[0];
                                playUrl = `/xem/${movieData.slug}/${firstEpisode.slug}/${encodeURIComponent(firstEpisode.server_name)}`;
                                $('#play-button').attr('href', playUrl).data('slug', movieData.slug).removeClass('disabled');
                            }
                        },
                        error: function (err) {
                            console.error(`Lỗi khi lấy danh sách tập của ${movieData.slug}:`, err);
                        }
                    });

                    $('#detail-button').attr('href', `/phim/${movieData.slug}`);
                }

                $(document).on('click', '.play-button', function (e) {
                    e.preventDefault();

                    const movieSlug = $(this).data('slug');
                    if (!movieSlug) {
                        console.error('Không tìm thấy slug của phim.');
                        return;
                    }

                    $.ajax({
                        url: `/api/movies/${movieSlug}`,
                        method: 'GET',
                        success: function (movie) {
                            if (!movie.episodes?.length) {
                                alert('Phim này chưa có tập nào.');
                                return;
                            }

                            const firstEpisode = movie.episodes[0];
                            const playUrl = `/xem/${movieSlug}/${firstEpisode.slug}/${encodeURIComponent(firstEpisode.server_name)}`;

                            window.location.href = playUrl; // Chuyển hướng ngay lập tức
                        },
                        error: function (err) {
                            console.error('Lỗi khi lấy thông tin phim:', err);
                            alert('Không thể tải dữ liệu phim.');
                        }
                    });
                });


                let detailTimeout;

                function showDetailCard(movieCard) {
                    clearTimeout(detailTimeout); // Xóa timeout cũ nếu có

                    let detailCard = $('#movie-detail');
                    let movieData = movieCard.data();
                    renderMovieDetails(movieData);

                    let position = movieCard.offset();
                    let cardWidth = movieCard.outerWidth();
                    let cardHeight = movieCard.outerHeight();
                    let detailWidth = detailCard.outerWidth();
                    let detailHeight = detailCard.outerHeight();
                    let windowWidth = $(window).width(); // Lấy chiều rộng màn hình

                    // Tính toán vị trí
                    let leftPos = position.left + (cardWidth / 2) - (detailWidth / 2);
                    let topPos = position.top + (cardHeight / 2) - (detailHeight / 2);

                    // Nếu vị trí bị tràn ra ngoài bên trái
                    if (leftPos < 10) {
                        leftPos = 10; // Giữ trong màn hình
                    }

                    // Nếu vị trí bị tràn ra ngoài bên phải
                    if (leftPos + detailWidth > windowWidth - 10) {
                        leftPos = windowWidth - detailWidth - 10;
                    }

                    detailCard.css({
                        top: `${topPos}px`,
                        left: `${leftPos}px`,
                        display: "block",
                        opacity: 0,
                        visibility: "hidden",
                        transform: "scale(0.9)"
                    });

                    detailTimeout = setTimeout(() => {
                        detailCard.css({
                            opacity: 1,
                            visibility: "visible",
                            transform: "scale(1)"
                        });
                    }, 500); // Giảm delay để phản hồi nhanh hơn
                }


                $(document).on('mouseenter', '.movie-card', function () {
                    let detailCard = $('#movie-detail');
                    clearTimeout(detailTimeout); // Xóa timeout cũ để tránh delay không mong muốn

                    if (detailCard.css("visibility") === "visible") {
                        detailCard.css({
                            transition: "none",
                            opacity: 0,
                            visibility: "hidden",
                            transform: "scale(0.9)"
                        });
                        setTimeout(() => {
                            detailCard.css("transition", "opacity 0.3s ease-in-out, transform 0.3s ease-in-out");
                            showDetailCard($(this));
                        }, 100);
                    } else {
                        showDetailCard($(this));
                    }
                });

                $(document).on('mouseleave', '.movie-card, #movie-detail', function () {
                    clearTimeout(detailTimeout); // Hủy timeout khi chuột rời đi
                    detailTimeout = setTimeout(function () {
                        if (!$('#movie-detail').is(':hover') && !$('.movie-card:hover').length) {
                            $('#movie-detail').css({
                                opacity: 0,
                                visibility: "hidden",
                                transform: "scale(0.9)"
                            });

                            setTimeout(() => {
                                if ($('#movie-detail').css('opacity') == 0) {
                                    $('#movie-detail').css("display", "none");
                                }
                            }, 300);
                        }
                    }, 300);
                });

                function initializeSwiper(selector) {
                    new Swiper(selector, {
                        pagination: {
                            el: '.swiper-pagination',
                            clickable: true,
                        },
                        navigation: {
                            nextEl: '.swiper-button-next',
                            prevEl: '.swiper-button-prev',
                        },
                        slidesPerView: 3,
                        spaceBetween: 30,
                        loop: true,
                    });
                }
                // Hàm Swiper duy nhất nhưng có thể tùy chỉnh
                function initializeSwiper(selector, slidesPerView = 3, spaceBetween = 0) {
                    new Swiper(selector, {
                        pagination: {
                            el: `${selector} .swiper-pagination`,
                            clickable: true,
                        },
                        navigation: {
                            nextEl: `${selector} .swiper-button-next`,
                            prevEl: `${selector} .swiper-button-prev`,
                        },
                        slidesPerView: slidesPerView,  // Nhận từ fetchMovies
                        spaceBetween: spaceBetween,  // Nhận từ fetchMovies
                        loop: true,
                    });
                }

                function fetchMoviesForCarousel(apiUrl) {
                    fetch(apiUrl)
                        .then(response => response.json())
                        .then(data => {
                            let carouselContent = '';
                            let indicatorsContent = '';

                            data.forEach((movie, index) => {
                                let activeClass = index === 0 ? 'active' : '';
                                let categories = movie.categories.map(category =>
                                    `<a href="/filter?genre=${category.slug}" class="btn-theme btn-theme-sm btn-white-brd">${category.name}</a>`).join(' ');

                                let countries = movie.countries.map(country =>
                                    `<a href="/filter?country=${country.slug}" class="btn-theme btn-theme-sm btn-white-brd">${country.name}</a>`).join(' ');

                                let typeText = typeMap[movie.type] || 'Unknown';
                                let statusText = statusMap[movie.status] || 'Unknown';

                                carouselContent += `
                                    <div class="item full-screen ${activeClass}" style="height: 695px; background-image: url('${movie.poster_url}');">
                                        <div class="container">
                                            <div class="carousel-centered">
                                                <div class="margin-b-40">
                                                    <h1 class="carousel-title">
                                                        ${movie.name} <span class="status-text">[${statusText}]</span>
                                                    </h1>
                                                    <p class="movie-content">${movie.content}</p>
                                                    <div class="movie-categories">
                                                        <a href="/filter?type=${movie.type}" class="btn-theme btn-theme-sm btn-white-brd text-uppercase">${typeText}</a>
                                                        ${countries} ${categories}
                                                    </div>
                                                </div>
                                                <div class="action-row">
                                                <a href="#" class="play-button" data-slug="${movie.slug}"><i class="bi bi-play-fill"></i></a>
                                                    <a href="/phim/${movie.slug}" class="detail-button"><i class="bi bi-info-lg"></i></a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                `;

                                indicatorsContent += `
                                    <li data-target="#carousel-example-generic" data-slide-to="${index}" class="${activeClass}" 
                                            style="background-image: url('${movie.thumb_url}');">
                                        </li>
                                    `;
                            });

                            document.querySelector('#carousel-content').innerHTML = carouselContent;
                            document.querySelector('#carousel-indicators').innerHTML = indicatorsContent;

                            // Khởi động lại carousel của Bootstrap
                            $('#carousel-example-generic').carousel({
                                interval: 7000
                            });
                        })
                        .catch(error => console.error(`Lỗi khi tải dữ liệu từ ${apiUrl}:`, error));
                }

                // Gọi hàm fetch cho Bootstrap Carousel
                fetchMoviesForCarousel('/api/movies');

                function fetchNewMovies(apiUrl, sliderSelector, slidesPerView = 3, spaceBetween = 30) {
                    fetch(apiUrl)
                        .then(response => response.json())
                        .then(data => {
                            let slidesContent = '';

                            data.forEach(function (movie) {
                                slidesContent += `
                                <a href="/phim/${movie.slug}">
                                    <div class="swiper-slide">
                                        <div class="movie-card" 
                                            data-name="${movie.name}" 
                                            data-year="${movie.year}" 
                                            data-quality="${movie.quality}" 
                                            data-lang="${movie.lang}" 
                                            data-slug="${movie.slug}"
                                            data-type="${movie.type}" 
                                            data-origin="${movie.origin_name}"
                                            data-status="${movie.status}" 
                                            data-poster="${movie.poster_url}" 
                                            data-countries="${movie.countries && Array.isArray(movie.countries) ? movie.countries.map(country => `${country.name} (${country.slug || ''})`).join(', ') : ''}"
                                            data-categories="${movie.categories && Array.isArray(movie.categories) ? movie.categories.map(category => `${category.name} (${category.slug || ''})`).join(', ') : ''}">
                                            <img class="full-width img-responsive fadeInUp" src="${movie.poster_url}" alt="${movie.name}">
                                            <div class="movie-detail-placeholder"></div>
                                        </div>
                                        <div class="text-center">
                                            <h5><a href="#">${movie.name}</a></h5>
                                        </div>
                                    </div>
                                    </a>
                                `;
                            });

                            document.querySelector(`${sliderSelector} .swiper-wrapper`).innerHTML = slidesContent;

                            // Khởi tạo Swiper với tham số tuỳ chỉnh
                            initializeSwiper(sliderSelector, slidesPerView, spaceBetween);
                        })
                        .catch(error => console.error(`Lỗi khi tải dữ liệu từ ${apiUrl}:`, error));
                }
                fetchNewMovies('/api/movies/anime', '#anime-slider', 3, 30); // Swiper mặc định
                fetchNewMovies('/api/movies/hanquoc', '#hanquoc-slider', 3, 30); // Swiper mặc định      
                fetchNewMovies('/api/movies/trungquoc', '#trungquoc-slider', 3, 30); // Swiper mặc định    
                // Hàm fetch dữ liệu và gọi initializeSwiper
                function fetchMovies(apiUrl, sliderSelector, slidesPerView = 3, spaceBetween = 30) {
                    fetch(apiUrl)
                        .then(response => response.json())
                        .then(data => {
                            let slidesContent = '';

                            data.forEach(movie => {
                                let typeText = typeMap[movie.type] || 'Unknown';
                                let statusText = statusMap[movie.status] || 'Unknown';

                                slidesContent += `
                                <a href="/phim/${movie.slug}">
                                    <div class="swiper-slide">
                                        <div class="movie-card"
                                            data-name="${movie.name}" 
                                            data-year="${movie.year}" 
                                            data-quality="${movie.quality}" 
                                            data-lang="${movie.lang}" 
                                            data-slug="${movie.slug}"
                                            data-type="${movie.type}"
                                            data-origin="${movie.origin_name}"
                                            data-status="${movie.status}"
                                            data-poster="${movie.poster_url}"
                                            data-countries="${movie.countries && Array.isArray(movie.countries) ? movie.countries.map(country => `${country.name} (${country.slug || ''})`).join(', ') : ''}"
                                            data-categories="${movie.categories && Array.isArray(movie.categories) ? movie.categories.map(category => `${category.name} (${category.slug || ''})`).join(', ') : ''}">
                                            <div class="movie-detail-placeholder"></div>
                                            <img class="poster" src="${movie.poster_url}" alt="${movie.name}">
                                        </div>
                                        <div>
                                            <img class="thumb" src="${movie.thumb_url}" alt="${movie.name}">
                                        </div>
                                        <div>
                                            <h4><a href="#">${movie.name}</a></h4>
                                            <p>${movie.year} • ${movie.quality} • ${statusText}</p>
                                        </div>
                                    </div>
                                    </a>
                                `;
                            });

                            document.querySelector(`${sliderSelector} .swiper-wrapper`).innerHTML = slidesContent;

                            // Khởi tạo Swiper với tham số tuỳ chỉnh
                            initializeSwiper(sliderSelector, slidesPerView, spaceBetween);
                        })
                        .catch(error => console.error(`Lỗi khi tải dữ liệu từ ${apiUrl}:`, error));
                }

                // Gọi hàm fetch với từng loại Swiper có tuỳ chỉnh
                fetchMovies('/api/movies/longtieng', '#longtieng-slider', 4, 0); // Swiper mặc định
                fetchMovies('/api/movies/chieurap', '#chieurap-slider', 3, 30); // Swiper mặc định



                function fetchOldMovies(apiUrl, sliderSelector, slidesPerView = 3, spaceBetween = 30) {
                    fetch(apiUrl)
                        .then(response => response.json())
                        .then(data => {
                            let slidesContent = '';

                            data.forEach(function (movie) {
                                slidesContent += `
                                <a href="/phim/${movie.slug}">
                                    <div class="swiper-slide">
                                        <div class="movie-card" 
                                            data-name="${movie.name}" 
                                            data-year="${movie.year}" 
                                            data-quality="${movie.quality}" 
                                            data-lang="${movie.lang}" 
                                            data-slug="${movie.slug}" 
                                            data-type="${movie.type}" 
                                            data-origin="${movie.origin_name}"
                                            data-status="${movie.status}" 
                                            data-poster="${movie.poster_url}" 
                                            data-countries="${movie.countries && Array.isArray(movie.countries) ? movie.countries.map(country => `${country.name} (${country.slug || ''})`).join(', ') : ''}"
                                            data-categories="${movie.categories && Array.isArray(movie.categories) ? movie.categories.map(category => `${category.name} (${category.slug || ''})`).join(', ') : ''}">
                                            <img class="img-responsive" style="height: 380px;" src="${movie.thumb_url}" alt="${movie.name}">
                                            <div class="movie-detail-placeholder"></div>
                                        </div>
                                        <div class="text-center">
                                            <h5><a href="#">${movie.name}</a></h5>
                                        </div>
                                    </div>
                                    </a>
                                `;
                            });

                            document.querySelector(`${sliderSelector} .swiper-wrapper`).innerHTML = slidesContent;

                            // Khởi tạo Swiper với tham số tuỳ chỉnh
                            initializeSwiper(sliderSelector, slidesPerView, spaceBetween);
                        })
                        .catch(error => console.error(`Lỗi khi tải dữ liệu từ ${apiUrl}:`, error));
                }
                fetchOldMovies('/api/movies/phimcu', '#phimcu-slider', 6, 0); // Swiper mặc định
                fetchOldMovies('/api/movies/tvshows', '#tvshows-slider', 6, 0); // Swiper mặc định
            });

        </script>
</body>

</html>